let _d_;const dMap=new Map,rMap=new WeakMap,dp=Object.defineProperty,doc=document,observe=e=>rctr((()=>{const t=_d_;_d_=e;const n=e();return _d_=t,n})),rctr=e=>{let t=e.valueOf();const n=Reflect,o=e=>{for(let t of[...dMap.get(e)||[]])"function"==typeof t?t():t.isConnected&&t!==this&&rMap.get(t)?.call(t)},r=()=>"function"==typeof t?t():t,a=new Proxy(e,{get(e,t){if("toJSON"===t||"valueOf"===t)return()=>r();if("toString"===t)return()=>r().toString();if("isReactor"===t)return!0;if("peek"===t)return r();_d_&&dMap.set(e,(dMap.get(e)||new Set).add(_d_));const o="value"===t?r():n.get(e,t);return o?.isReactor?o:o&&"object"==typeof o?e[t]=rctr(o):o},set:(e,r,a)=>(t!==a&&("value"===r?t=a:n.set(e,r,a),o(e)),!0),deleteProperty(e,r){let a=!0;"value"===r?t=void 0:n.deleteProperty(e,r,v),o(e)}});return"function"==typeof e&&r(),a},state=e=>({object:e=>e?rctr(e):e,function:e=>rctr(e),boolean:e=>rctr(new Boolean(e)),number:e=>rctr(new Number(e)),string:e=>rctr(new String(e)),bigint:e=>rctr(new BigInt(e)),undefined(e){}}[typeof e](e)),tags=new Proxy({},{get:(e,t)=>(e,...n)=>function o(){e?(o.attrs=e,n&&(o.children=n),"function"==typeof e&&(e=e())):(e="function"==typeof o.attrs?o.attrs():o.attrs||{},n=o.children);const r=_d_,a=doc.createElement(t),s=typeof e;(["string","number","boolean","bigint"].some((t=>t===s||t===e.constructor.name.toLowerCase()))||"object"===s&&(e instanceof Node||e instanceof Array))&&(n=[e,...n],e={}),n=n.flat(),rMap.set(a,o),_d_=a,!e.oncreate||e.oncreate(dp(new Event("create",{bubbles:!0,cancelable:!1}),"target",{value:a}));for(let t in e){if(!isNaN(parseInt(t)))continue;if(t.startsWith("on")){a.addEventListener(t.substring(2).toLowerCase(),(async n=>{const o=_d_;_d_=n.target,await e[t](n),_d_=o}));continue}const n="function"==typeof e[t]?e[t].call(a):e[t],o=typeof n;"style"===t&&"object"===o?Object.assign(a.style,n):"dataset"===t?Object.assign(a.dataset,n):"value"===t?a.value=n:a.setAttribute(t,n&&"object"===o?JSON.stringify(n):n),"href"===t&&xsui.load&&dp(a,"load",{configurable:!0,value:xsui.load})}for(let e of n)"function"==typeof e&&(e=e()),e.nodeType===Node.TEXT_NODE||e&&"object"==typeof e&&e instanceof Node?a.appendChild(e):a.appendChild(doc.createTextNode(e+""));return _d_=r,this instanceof Node&&(rMap.delete(this),this.replaceWith(a)),a}()}),xsui=({load:e}={})=>(e&&(xsui.load=e),xsui);Object.assign(xsui,{tags:tags,state:state,observe:observe});export{xsui,xsui as default};